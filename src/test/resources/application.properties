# ===================================================================
# CONFIGURACIÓN DE SPRING BOOT PARA EL ENTORNO DE PRUEBAS (TEST)
# ===================================================================
# Este archivo se activa por @ActiveProfiles("test") en BaseRepositoryTest.

spring.application.name=dawazon-Test

# ===================================================================
# BASE DE DATOS (PROVISTA POR TESTCONTAINERS)
# ===================================================================

# ¡¡IMPORTANTE!!
# NO definimos 'spring.datasource.url', 'username', o 'password'.
# Estas propiedades se inyectan dinámicamente desde 'BaseRepositoryTest.java'
# usando @DynamicPropertySource.

# 2. Configuración de JPA (Hibernate) para TESTS
spring.jpa.show-sql=true
# El dialecto sigue siendo necesario para que Hibernate sepa cómo hablar con Postgres
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

spring.jpa.properties.hibernate.format_sql=false

# 'create-drop': Sigue siendo la estrategia IDEAL para tests.
# Spring/Hibernate usará la conexión de Testcontainers para crear y borrar
# el esquema en la base de datos temporal.
spring.jpa.hibernate.ddl-auto=create-drop


# ===================================================================
# CONFIGURACIÓN DE UPLOADS (PARA TESTS)
# (Copiado de tu 'application.properties' principal para consistencia)
# ===================================================================
# Usamos un directorio de imágenes específico para tests para no
# interferir con las imágenes de desarrollo.
upload.root-location=test-images
# Borrar las imágenes de test al arrancar está bien.
upload.delete=true

# Tamaño de archivos
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ===================================================================
# MAILTRAP (SIN CAMBIOS)
# (Es un sandbox, por lo que es seguro usarlo en tests)
# ===================================================================
spring.mail.host=${MAIL_HOST:sandbox.smtp.mailtrap.io}
spring.mail.port=${MAIL_PORT:2525}
spring.mail.username=${MAIL_USERNAME:a422f93316a7c8}
spring.mail.password=${MAIL_PASSWORD:8fa17f600a0958}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=false
spring.mail.properties.mail.smtp.ssl.enable=false
spring.mail.properties.mail.debug=true

# Email desde donde se envían los correos
app.mail.from=${MAIL_FROM:noreply@tienda.dev}

# Logging
logging.level.org.springframework.mail=DEBUG

spring.autoconfigure.exclude=com.stripe.StripeConfiguration
# ===================================================================
# SERVIDOR
# ===================================================================
server.port=8080
server.url=http://localhost:8080

# ===================================================================
# STRIPE (CONFIGURACIÓN DE PRUEBA)
# ===================================================================
stripe.key=sk_test_fake_key_for_testing_only
