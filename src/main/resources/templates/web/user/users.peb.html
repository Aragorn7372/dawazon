{% include "common/header" %}
{% include "common/navbar" %}
<header class="bg-custom-dark text-white py-2">
    <div class="container d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-3">
            <h5 class="m-0">Panel Admin</h5>
        </div>
    </div>
</header>
<!-- Main container -->
<main class="container col-12 mt-4">
    <h2 class="text-center mb-3">usuarios admin</h2>

    <!-- Controls: búsqueda + botón nuevo -->
    <div class="row align-items-center mb-3">
        <form action="/users" class="d-flex me-3" method="get" role="search"></form>
        <div class="col-md-6 mb-2">
            <div class="input-group">
                <input id="searchInput" type="search" name="name" class="form-control search-input"
                       placeholder="Buscar por nombre, email o rol..." value="{{name | default('')}}">
                <button id=" btnSearch" class="btn btn-search" type="submit"><i class="bi bi-search"></i>
                    Buscar
                </button>

            </div>

        </div>
        </form>
        <div class="col-md-6 text-end">
            <button id="btnAddUser" class="btn btn-amazon" data-bs-toggle="modal" data-bs-target="#editUserModal">
                <i class="bi bi-person-plus"></i> Nuevo usuario
            </button>
        </div>
    </div>

    <!-- Tabla responsive -->
    <div class="table-responsive">
        <table id="usersTable" class="table align-middle users-table">
            <thead>
            <tr>
                <th scope="col"></th>
                <th scope="col">Nombre</th>
                <th scope="col">Email</th>
                <th scope="col">Roles</th>
                <th scope="col">Estado</th>
                <th scope="col" class="text-end">Acciones</th>
            </tr>
            </thead>
            <tbody>
            {% if users is empty %}
            <tr>
                <td colspan="6" class="text-center text-muted">No se encontraron usuarios.</td>
            </tr>
            {% endif %}
            {% for user in users %}
            <tr>
                <td>
                    <img src="data:image/svg+xml;utf8,<svg xmlns='{{user.getAvatar}}' width='80' height='80'><rect width='100%' height='100%' fill='%23888'/></svg>"
                         alt="{{user.getName}}" class="avatar-small">
                </td>
                <td>
                    <div>user.getName</div>
                    <div class="text-muted-small">user.getUserName</div>
                </td>
                <td>user.getEmail</td>
                <td>
                    {% for role in user.getRoles %}
                    <span class="role-badge">role</span>
                    {% endfor %}
                </td>
                <td>
                            <span class="status-badge">{% if user.isDeleted %} Activo {% else %} Inactivo {% endif
                                %}</span>
                </td>
                <td class="text-end actions-cell">
                    <button onclick="edit(this,{{user.getId}})" class="btn btn-gradient action-edit"><i
                            class="bi bi-pencil"></i>
                        editar
                    </button>
                    <button onclick="deleted(this,{{user.getId}})" class="action-delete"
                            title="Eliminar usuario"><i class="bi bi-trash"></i></button>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</main>
<script>

    function edit(element, userId) {
        window.location.href = `/users/edit/${productoId}`;
    }

    function deleted(element, userId) {
        window.location.href = `/users/delete/${productoId}`;
    }

</script>
{% include "common/footer" %}
